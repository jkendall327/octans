@using Octans.Core.Models.Duplicates

<MudCard Class="ma-2 pa-2">
    <MudCardHeader>
        <CardHeaderContent>
            <MudText Typo="Typo.h6">Similarity: @Candidate.Distance.ToString("F1")%</MudText>
        </CardHeaderContent>
        <CardHeaderActions>
             <MudButton Variant="Variant.Filled" Color="Color.Default" OnClick="@(() => OnResolve(DuplicateResolution.KeepBoth, null))">Keep Both</MudButton>
             <MudButton Variant="Variant.Filled" Color="Color.Default" OnClick="@(() => OnResolve(DuplicateResolution.Distinct, null))">Not Duplicates</MudButton>
        </CardHeaderActions>
    </MudCardHeader>
    <MudCardContent>
        <MudGrid>
            <MudItem xs="6">
                <MudPaper Class="d-flex flex-column align-center pa-2 cursor-pointer hover-effect" @onclick="@(() => OnResolve(DuplicateResolution.KeepBoth, Candidate.HashId1))">
                    <MudImage Src="@Candidate.Url1" ObjectFit="ObjectFit.Contain" Height="300" Class="rounded-lg"/>
                    <MudText Typo="Typo.caption">ID: @Candidate.HashId1</MudText>
                    <MudButton Variant="Variant.Filled" Color="Color.Primary" Class="mt-2">Keep This</MudButton>
                </MudPaper>
            </MudItem>
            <MudItem xs="6">
                <MudPaper Class="d-flex flex-column align-center pa-2 cursor-pointer hover-effect" @onclick="@(() => OnResolve(DuplicateResolution.KeepBoth, Candidate.HashId2))">
                    <MudImage Src="@Candidate.Url2" ObjectFit="ObjectFit.Contain" Height="300" Class="rounded-lg"/>
                    <MudText Typo="Typo.caption">ID: @Candidate.HashId2</MudText>
                    <MudButton Variant="Variant.Filled" Color="Color.Primary" Class="mt-2">Keep This</MudButton>
                </MudPaper>
            </MudItem>
        </MudGrid>
    </MudCardContent>
</MudCard>

@code {
    [Parameter] public required DuplicateCandidateDto Candidate { get; set; }
    [Parameter] public EventCallback<(int CandidateId, DuplicateResolution Resolution, int? KeepHashId)> OnResolution { get; set; }

    private async Task OnResolve(DuplicateResolution resolution, int? keepHashId)
    {
        await OnResolution.InvokeAsync((Candidate.Id, resolution, keepHashId));
    }
}
