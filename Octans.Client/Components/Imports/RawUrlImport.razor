@using Octans.Core.Importing
@inject IRawUrlImportViewmodel Viewmodel

<div class="input-group">
    <textarea
        @bind="Viewmodel.UrlInput"
        placeholder="Enter URLs (one per line)"
        rows="5"
        class="url-input">
                </textarea>
</div>

<div class="import-options">
    <label class="option">
        <input type="checkbox" @bind="Viewmodel.AllowReimportDeleted"/>
        Allow reimport of deleted items
    </label>
</div>

<button class="send-button" @onclick="@SendUrls" disabled="@(string.IsNullOrWhiteSpace(Viewmodel.UrlInput))">
    Import
</button>

@code {

    private async Task SendUrls()
    {
        if (string.IsNullOrWhiteSpace(Viewmodel.UrlInput))
            return;

        var urls = Viewmodel.UrlInput
            .Split(['\r', '\n'], StringSplitOptions.RemoveEmptyEntries)
            .Select(url => url.Trim())
            .Where(url => !string.IsNullOrWhiteSpace(url))
            .ToList();

        if (urls.Count > 0)
        {
            await Viewmodel.SendUrlsToServer(urls, ImportType.RawUrl, Viewmodel.AllowReimportDeleted);
            Viewmodel.UrlInput = string.Empty;
        }
    }

}