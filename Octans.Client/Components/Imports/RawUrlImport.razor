@using Octans.Core.Importing
@inject IRawUrlImportViewmodel Viewmodel

<div class="input-group">
    <textarea
        @bind="_urlInput"
        placeholder="Enter URLs (one per line)"
        rows="5"
        class="url-input">
                </textarea>
</div>

<div class="import-options">
    <label class="option">
        <input type="checkbox" @bind="_allowReimportDeleted"/>
        Allow reimport of deleted items
    </label>
</div>

<button class="send-button" @onclick="@SendUrls" disabled="@(string.IsNullOrWhiteSpace(_urlInput))">
    Import
</button>

@code {
    private string _urlInput = string.Empty;
    private bool _allowReimportDeleted;

    private async Task SendUrls()
    {
        if (string.IsNullOrWhiteSpace(_urlInput))
            return;

        var urls = _urlInput
            .Split(['\r', '\n'], StringSplitOptions.RemoveEmptyEntries)
            .Select(url => url.Trim())
            .Where(url => !string.IsNullOrWhiteSpace(url))
            .ToList();

        if (urls.Count > 0)
        {
            await Viewmodel.SendUrlsToServer(urls, ImportType.RawUrl, _allowReimportDeleted);
            _urlInput = string.Empty;
        }
    }

}